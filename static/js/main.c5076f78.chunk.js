(this.webpackJsonpnightfall=this.webpackJsonpnightfall||[]).push([[0],{22:function(t,e,n){},23:function(t,e,n){},3:function(t,e,n){t.exports={wrapper:"Game_wrapper__3oH14",selected:"Game_selected__7QQur",unitInfo:"Game_unitInfo__1r61w",mapAndInfo:"Game_mapAndInfo__2_8Qy",button:"Game_button__P34Uo"}},30:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),o=n(8),c=n.n(o),i=(n(22),n(23),n(15)),s=n(17),u=n(2),l=function(){return Object(u.b)()},f=(u.c,n(3)),d=n.n(f),h=n(4),v=n(14),m=n(5),j=n(9),b=function(t,e){return t.x===e.x&&t.y===e.y},p=function(t){return t.x+"-"+t.y},g=function(t){var e=t.split("-");return{x:parseInt(e[0]),y:parseInt(e[1])}},x=function(t){for(var e=-1e3,n=-1e3,r=0,a=Object.keys(t);r<a.length;r++){var o=a[r],c=g(o),i=c.x,s=c.y;i>e&&(e=i),s>n&&(n=s)}return{width:e+1,height:n+1}},y=function(t,e){return t.hasOwnProperty(p(e))&&!0===t[p(e)]},O=function(t){return t.positions[t.positions.length-1]},k=function(t,e){return t.filter((function(t){return y(e,t)}))},U=function(t,e){return t.filter((function(t){return!S(e,t)}))},w=function(t,e){return t.filter((function(t){var n,r=Object(h.a)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(b(t,a))return!1}}catch(o){r.e(o)}finally{r.f()}return!0}))},C=function(t,e){for(var n=[],r=-e;r<=e;r++)for(var a=-e+Math.abs(r);a<=e-Math.abs(r);a++)n.push({x:t.x+r,y:t.y+a});return n},_=n(32),I=function(t){return _.a(t,1,.6).toString()},M=function(t){return _.a(t,1.2,.3).toString()},A=[{positions:[{x:0,y:0}],movesUsed:0,attackUsed:!1,stats:{name:"Heavy hitter",maxLength:5,range:1,movement:2,attack:3,color:I(0),headColor:M(0),id:"a"}},{positions:[{x:4,y:4}],movesUsed:0,attackUsed:!1,stats:{name:"Ranged and slow",maxLength:2,range:3,movement:1,attack:1,color:I(100),headColor:M(100),id:"b"}},{positions:[{x:9,y:9}],movesUsed:0,attackUsed:!1,stats:{name:"Glass cannon",maxLength:1,range:1,movement:5,attack:2,color:I(200),headColor:M(200),id:"c"}}],G=function(t,e){for(var n={},r=0;r<t;r+=1)for(var a=0;a<e;a+=1)n[p({x:r,y:a})]=!0;return n}(10,10);G["6-6"]=!1,G["6-5"]=!1;var E={turn:0,phase:"move",grid:G,units:A.reduce((function(t,e){return t[e.stats.id]=e,t}),{}),selectedUnit:"a",players:[{name:"Jake",unitIds:["a","b"]},{name:"Cypress",unitIds:["c"]}]},S=function(t,e){var n,r=Object(h.a)(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(L(a.positions,e))return!0}}catch(o){r.e(o)}finally{r.f()}return!1},L=function(t,e){var n,r=Object(h.a)(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.x===e.x&&a.y===e.y)return!0}}catch(o){r.e(o)}finally{r.f()}return!1},N=function(t,e){var n,r=Object(h.a)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(L(a.positions,t))return a}}catch(o){r.e(o)}finally{r.f()}},P=Object(m.c)({name:"game",initialState:E,reducers:{move:function(t,e){if("move"===t.phase&&void 0!==t.selectedUnit){var n=t.units[t.selectedUnit];if(!(n.movesUsed>=n.stats.movement)){var r=$(t);(function(t,e,n,r){var a=n.positions,o=a[a.length-1];return Math.abs(r.x-o.x)+Math.abs(r.y-o.y)<=1&&!S(e,r)&&y(t,r)})(t.grid,r,n,e.payload)&&(n.positions.push(e.payload),n.movesUsed++),n.positions.length>n.stats.maxLength&&n.positions.shift()}}},select:function(t,e){var n=q(t),r=N(e.payload,n);r&&(t.phase="move",t.selectedUnit=r.stats.id)},reset:function(){return E},attack:function(t,e){var n=e.payload,r=V(t),a=N(n,r);if("attack"===t.phase&&void 0!==t.selectedUnit&&a){var o=t.units[t.selectedUnit];o!==a&&!o.attackUsed&&function(t,e){var n=O(t);return Math.abs(n.x-e.x)+Math.abs(n.y-e.y)<=t.stats.range}(o,n)&&(o.attackUsed=!0,o.stats.attack>=a.positions.length&&(delete t.units[a.stats.id],X(t),t.players.length<2&&(t.winner=t.players[0].name,t.phase="game over")),a.positions.splice(0,o.stats.attack))}},endTurn:function(t){t.turn++;var e,n=Object(h.a)($(t));try{for(n.s();!(e=n.n()).done;){var r=e.value;r.movesUsed=0,r.attackUsed=!1}}catch(a){n.e(a)}finally{n.f()}t.selectedUnit=q(t)[0].stats.id},clickMove:function(t){var e=K(t);e&&e.movesUsed<e.stats.movement&&(t.phase="move")},clickAttack:function(t){var e=K(t);e&&!e.attackUsed&&(t.phase="attack")}}}),B=P.actions,T=B.move,J=B.select,Q=B.attack,H=B.reset,R=B.endTurn,W=B.clickMove,F=B.clickAttack,$=function(t){return Object.values(t.units)},q=function(t){return z(t,D(t))},z=function(t,e){return e.unitIds.map((function(e){return t.units[e]})).filter((function(t){return void 0!==t}))},D=function(t){return t.players[t.turn%t.players.length]},K=function(t){return t.selectedUnit?t.units[t.selectedUnit]:void 0},V=function(t){var e=D(t).unitIds,n=t.units;return Object.keys(n).filter((function(t){return!e.includes(t)})).map((function(t){return n[t]}))},X=function(t){t.players=t.players.filter((function(e){return z(t,e).length>0}))},Y=function(t){return $(t.game)},Z=function(t){return q(t.game)},tt=function(t){return D(t.game)},et=function(t){return K(t.game)},nt=Object(j.a)(et,(function(t){return t.game.phase}),Y,(function(t){return t.game.grid}),(function(t,e){var n,r={};return t?("attack"!==e||t.attackUsed||(n=t,C(O(n),n.stats.range)).forEach((function(t){r[p(t)]="#ff0000"})),t.positions.forEach((function(t){r[p(t)]="#384bfa"})),r):r})),rt=Object(j.a)(et,(function(t){return t.game.phase}),Y,(function(t){return t.game.grid}),tt,(function(t,e,n,r,a){var o={};(Object.entries(r).filter((function(t){var e=Object(v.a)(t,2);e[0];return!e[1]})).forEach((function(t){var e=Object(v.a)(t,2),n=e[0];e[1];o[n]="#ffffff"})),n.forEach((function(t){var e=a.unitIds.includes(t.stats.id),n=_.a(t.stats.color),r=_.a(t.stats.headColor);e||(n.s*=.2,r.s*=.2,r.l*=1.5),t.positions.forEach((function(t){o[p(t)]=n.toString()})),o[p(O(t))]=r.toString()})),t&&"move"===e)&&function(t,e,n){for(var r,a={position:O(t),movement:t.stats.movement-t.movesUsed},o=[a],c=[],i=a;0!==o.length;){var s=o.shift();if(void 0===s)return[];if(b((i=s).position,O(t))||c.push(i.position),0!==i.movement){var u,l=(r=i.position,C(r,1)),f=k(l,n),d=U(f,e),v=w(d,c),m=Object(h.a)(v);try{for(m.s();!(u=m.n()).done;){var j={position:u.value,movement:i.movement-1};o.push(j)}}catch(p){m.e(p)}finally{m.f()}}}return c}(t,n,r).forEach((function(t){o[p(t)]="rgb(201, 230, 253)"}));return o})),at=P.reducer,ot=n(1),ct=function(t){var e=t.position,n=t.color,r=t.glowColor,a=t.phase,o=l(),c=Object(u.c)(Y),i=Object(u.c)(Z),s={backgroundColor:n,boxShadow:r?"0px 0px 10px"+r:void 0,transition:"background-color 0.2s"};return Object(ot.jsx)("div",{style:s,onClick:function(){var t=N(e,c);if(t&&i.includes(t))o(J(e));else switch(a){case"move":(function(t,e){return void 0===N(t,e)})(e,c)&&o(T(e));break;case"attack":o(Q(e))}}})},it=function(t){var e=t.unit;return Object(ot.jsxs)("div",{className:d.a.unitInfo,children:[Object(ot.jsx)("h2",{style:{color:e.stats.headColor},children:e.stats.name}),Object(ot.jsx)("table",{children:Object(ot.jsxs)("tbody",{children:[Object(ot.jsxs)("tr",{children:[Object(ot.jsx)("th",{children:"Movement range"}),Object(ot.jsx)("td",{children:e.stats.movement})]}),Object(ot.jsxs)("tr",{children:[Object(ot.jsx)("th",{children:"Attack range"}),Object(ot.jsx)("td",{children:e.stats.range})]}),Object(ot.jsxs)("tr",{children:[Object(ot.jsx)("th",{children:"Max Length"}),Object(ot.jsx)("td",{children:e.stats.maxLength})]}),Object(ot.jsxs)("tr",{children:[Object(ot.jsx)("th",{children:"Attack"}),Object(ot.jsx)("td",{children:e.stats.attack})]})]})})]})},st=function(t,e,n,r){return Object(s.a)(Array(x(t).height*x(t).width).keys()).map((function(a){var o=function(t,e){var n=x(e);return{x:Math.floor(t/n.width),y:t%n.height}}(a,t),c=e[p(o)],i=n[p(o)];return Object(ot.jsx)(ct,{color:i,glowColor:c,position:o,phase:r},a)}))};function ut(){var t=l(),e=Object(u.c)((function(t){return Object(i.a)(Object(i.a)({},t.game),{},{selectedUnit:et(t),gridGlows:nt(t),gridColors:rt(t),activePlayer:tt(t)})})),n=e.grid,r=e.phase,o=e.selectedUnit,c=e.gridGlows,s=e.gridColors,f=e.activePlayer;return Object(ot.jsxs)(a.a.Fragment,{children:["game over"===r&&Object(ot.jsxs)("h1",{children:["Game over, ",f.name," wins!"]}),"game over"!==r&&Object(ot.jsxs)("h1",{children:[f.name,":","move"===r&&Object(ot.jsx)("button",{onClick:function(){return t(F())},className:d.a.button,children:"Attack"}),"attack"===r&&o&&Object(ot.jsx)("button",{onClick:function(){return t(W())},className:d.a.button,disabled:o.movesUsed===o.stats.movement,children:"Move"}),Object(ot.jsx)("button",{onClick:function(){return t(R())},className:d.a.button,children:"End Turn"})]}),Object(ot.jsxs)("div",{id:d.a.mapAndInfo,children:[Object(ot.jsx)("div",{className:d.a.wrapper,children:st(n,c,s,r)}),o&&Object(ot.jsx)(it,{unit:o})]}),Object(ot.jsx)("button",{onClick:function(){return t(H())},children:"reset"})]})}var lt=function(){return Object(ot.jsx)(ut,{})},ft=n(13),dt=n.n(ft),ht=n(16);function vt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new Promise((function(e){return setTimeout((function(){return e({data:t})}),500)}))}var mt=Object(m.b)("counter/fetchCount",function(){var t=Object(ht.a)(dt.a.mark((function t(e){var n;return dt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,vt(e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),jt=Object(m.c)({name:"counter",initialState:{value:0,status:"idle"},reducers:{increment:function(t){t.value+=1},decrement:function(t){t.value-=1},incrementByAmount:function(t,e){t.value+=e.payload}},extraReducers:function(t){t.addCase(mt.pending,(function(t){t.status="loading"})).addCase(mt.fulfilled,(function(t,e){t.status="idle",t.value+=e.payload}))}}),bt=jt.actions,pt=(bt.increment,bt.decrement,bt.incrementByAmount,jt.reducer),gt=Object(m.a)({reducer:{counter:pt,game:at}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(ot.jsx)(a.a.StrictMode,{children:Object(ot.jsx)(u.a,{store:gt,children:Object(ot.jsx)(lt,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[30,1,2]]]);
//# sourceMappingURL=main.c5076f78.chunk.js.map