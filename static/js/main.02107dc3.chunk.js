(this.webpackJsonpnightfall=this.webpackJsonpnightfall||[]).push([[0],{20:function(t,e,n){},21:function(t,e,n){},28:function(t,e,n){"use strict";n.r(e);var a=n(0),r=n.n(a),o=n(6),i=n.n(o),s=(n(20),n(21),n(13)),c=n(15),u=n(4),l=n(2),d=function(){return Object(l.b)()},f=(l.c,n(8)),h=n.n(f),v=n(3),p={turn:0,phase:"action",gridSize:{width:10,height:10},units:[{positions:[{x:0,y:0}],movesUsed:0,attackUsed:!1,stats:{name:"Red",maxLength:5,range:1,movement:2,attack:3,color:"red",headColor:"brown",id:"a"}},{positions:[{x:4,y:4}],movesUsed:0,attackUsed:!1,stats:{name:"Yellow",maxLength:2,range:3,movement:1,attack:1,color:"yellow",headColor:"green",id:"b"}},{positions:[{x:9,y:9}],movesUsed:0,attackUsed:!1,stats:{name:"Purple",maxLength:1,range:1,movement:5,attack:2,color:"purple",headColor:"pink",id:"p"}}].reduce((function(t,e){return t[e.stats.id]=e,t}),{})},m=function(t,e){var n,a=Object(u.a)(t);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(r.x===e.x&&r.y===e.y)return!0}}catch(o){a.e(o)}finally{a.f()}return!1},b=function(t,e,n){var a=e.positions,r=a[a.length-1];return Math.abs(n.x-r.x)+Math.abs(n.y-r.y)<=1&&!function(t,e){var n,a=Object(u.a)(t);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(m(r.positions,e))return!0}}catch(o){a.e(o)}finally{a.f()}return!1}(t,n)},j=function(t,e){var n,a=Object(u.a)(e);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(m(r.positions,t))return r}}catch(o){a.e(o)}finally{a.f()}},y=Object(v.c)({name:"game",initialState:p,reducers:{move:function(t,e){if("action"===t.phase&&void 0!==t.selectedUnit){var n=t.units[t.selectedUnit];n.movesUsed>=n.stats.movement||(b(M(t),n,e.payload)&&(n.positions.push(e.payload),n.movesUsed++),n.positions.length>n.stats.maxLength&&n.positions.shift())}},select:function(t,e){var n=j(e.payload,M(t));n&&(t.phase="action",t.selectedUnit=n.stats.id)},reset:function(){return p},attack:function(t,e){var n=e.payload,a=j(n,M(t));if("action"===t.phase&&void 0!==t.selectedUnit&&a){var r=t.units[t.selectedUnit];r!==a&&!r.attackUsed&&function(t,e){var n=t.positions[t.positions.length-1];return Math.abs(n.x-e.x)+Math.abs(n.y-e.y)<=t.stats.range}(r,n)&&(r.attackUsed=!0,r.stats.attack>=a.positions.length&&delete t.units[a.stats.id],a.positions.splice(0,r.stats.attack))}},endTurn:function(t){t.turn++;var e,n=Object(u.a)(M(t));try{for(n.s();!(e=n.n()).done;){var a=e.value;a.movesUsed=0,a.attackUsed=!1}}catch(r){n.e(r)}finally{n.f()}}}}),g=y.actions,x=g.move,O=g.select,k=g.attack,w=g.reset,U=g.endTurn,C=function(t){return t.selectedUnit?t.units[t.selectedUnit]:void 0},M=function(t){return Object.values(t.units)},_=y.reducer,S=n(1),T=function(t){var e=t.position,n=t.color,a=t.selected,r=d(),o=Object(l.c)((function(t){return M(t.game)})),i=function(t){switch(t.button){case 0:if(function(t,e){return void 0===j(t,e)}(e,o)){r(x(e));break}r(O(e));break;case 2:r(k(e)),t.preventDefault()}};return Object(S.jsx)("div",{style:{backgroundColor:n},className:a?h.a.selected:void 0,onContextMenu:i,onClick:i})},B=function(t,e){var n,a=Object(u.a)(e);try{for(a.s();!(n=a.n()).done;)for(var r=n.value,o=0;o<r.positions.length;o++){var i=r.positions[o];if(i.x===t.x&&i.y===t.y)return o===r.positions.length-1?r.stats.headColor:r.stats.color}}catch(s){a.e(s)}finally{a.f()}},L=function(t,e){return{x:Math.floor(t/e.width),y:t%e.height}},A=function(t,e){return!!e&&e.positions.some((function(e){return e.x===t.x&&e.y===t.y}))},z=function(t,e,n){return Object(c.a)(Array(t.height*t.width).keys()).map((function(a){return Object(S.jsx)(T,{color:B(L(a,t),e),selected:A(L(a,t),n),position:L(a,t)},a)}))};function E(){var t=d(),e=Object(l.c)((function(t){return Object(s.a)(Object(s.a)({},t.game),{},{units:M(t.game),selectedUnit:C(t.game)})})),n=e.gridSize,a=e.phase,o=e.selectedUnit,i=e.turn,c=e.units;return Object(S.jsxs)(r.a.Fragment,{children:[Object(S.jsxs)("p",{children:["Turn ",i+1]})," ",Object(S.jsx)("button",{onClick:function(){return t(U())},children:"End Turn"}),Object(S.jsxs)("p",{children:[a,void 0!==o?": "+o.stats.name:""]}),Object(S.jsx)("div",{className:h.a.wrapper,children:z(n,c,o)}),Object(S.jsx)("button",{onClick:function(){return t(w())},children:"reset"})]})}var G=function(){return Object(S.jsx)(E,{})},J=n(12),N=n.n(J),P=n(14);function Q(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new Promise((function(e){return setTimeout((function(){return e({data:t})}),500)}))}var R=Object(v.b)("counter/fetchCount",function(){var t=Object(P.a)(N.a.mark((function t(e){var n;return N.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Q(e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),W=Object(v.c)({name:"counter",initialState:{value:0,status:"idle"},reducers:{increment:function(t){t.value+=1},decrement:function(t){t.value-=1},incrementByAmount:function(t,e){t.value+=e.payload}},extraReducers:function(t){t.addCase(R.pending,(function(t){t.status="loading"})).addCase(R.fulfilled,(function(t,e){t.status="idle",t.value+=e.payload}))}}),D=W.actions,F=(D.increment,D.decrement,D.incrementByAmount,W.reducer),H=Object(v.a)({reducer:{counter:F,game:_}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(S.jsx)(r.a.StrictMode,{children:Object(S.jsx)(l.a,{store:H,children:Object(S.jsx)(G,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},8:function(t,e,n){t.exports={wrapper:"Game_wrapper__3oH14",selected:"Game_selected__7QQur"}}},[[28,1,2]]]);
//# sourceMappingURL=main.02107dc3.chunk.js.map