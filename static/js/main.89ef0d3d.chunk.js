(this.webpackJsonpnightfall=this.webpackJsonpnightfall||[]).push([[0],{14:function(t,e,n){t.exports={wrapper:"Game_wrapper__3oH14",selected:"Game_selected__7QQur"}},21:function(t,e,n){},22:function(t,e,n){},29:function(t,e,n){"use strict";n.r(e);var r=n(0),o=n.n(r),a=n(6),i=n.n(a),c=(n(21),n(22),n(13)),s=n(16),u=n(2),f=function(){return Object(u.b)()},l=(u.c,n(14)),d=n.n(l),h=n(3),v=n(4),p=n(7),m=function(t,e){return t.x===e.x&&t.y===e.y},b=function(t){return t.x+"-"+t.y},g=function(t){return t.positions[t.positions.length-1]},j=function(t,e,n){return t.filter((function(t){return t.x>=0&&t.x<e&&t.y>=0&&t.y<n}))},y=function(t,e){return t.filter((function(t){return!w(e,t)}))},x=function(t,e){return t.filter((function(t){var n,r=Object(h.a)(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(m(t,o))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}))},O=function(t,e){for(var n=[],r=-e;r<=e;r++)for(var o=-e+Math.abs(r);o<=e-Math.abs(r);o++)n.push({x:t.x+r,y:t.y+o});return n},k={turn:0,phase:"action",gridSize:{width:10,height:10},units:[{positions:[{x:0,y:0}],movesUsed:0,attackUsed:!1,stats:{name:"Red",maxLength:5,range:1,movement:2,attack:3,color:"red",headColor:"brown",id:"a"}},{positions:[{x:4,y:4}],movesUsed:0,attackUsed:!1,stats:{name:"Yellow",maxLength:2,range:3,movement:1,attack:1,color:"yellow",headColor:"rgb(228, 208, 34)",id:"b"}},{positions:[{x:9,y:9}],movesUsed:0,attackUsed:!1,stats:{name:"Purple",maxLength:1,range:1,movement:5,attack:2,color:"purple",headColor:"pink",id:"p"}}].reduce((function(t,e){return t[e.stats.id]=e,t}),{})},w=function(t,e){var n,r=Object(h.a)(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(U(o.positions,e))return!0}}catch(a){r.e(a)}finally{r.f()}return!1},U=function(t,e){var n,r=Object(h.a)(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(o.x===e.x&&o.y===e.y)return!0}}catch(a){r.e(a)}finally{r.f()}return!1},C=function(t,e){var n,r=Object(h.a)(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(U(o.positions,t))return o}}catch(a){r.e(a)}finally{r.f()}},M=Object(v.c)({name:"game",initialState:k,reducers:{move:function(t,e){if("action"===t.phase&&void 0!==t.selectedUnit){var n=t.units[t.selectedUnit];if(!(n.movesUsed>=n.stats.movement))(function(t,e,n){var r=e.positions,o=r[r.length-1];return Math.abs(n.x-o.x)+Math.abs(n.y-o.y)<=1&&!w(t,n)})(L(t),n,e.payload)&&(n.positions.push(e.payload),n.movesUsed++),n.positions.length>n.stats.maxLength&&n.positions.shift()}},select:function(t,e){var n=L(t),r=C(e.payload,n);r&&(t.phase="action",t.selectedUnit=r.stats.id)},reset:function(){return k},attack:function(t,e){var n=e.payload,r=L(t),o=C(n,r);if("action"===t.phase&&void 0!==t.selectedUnit&&o){var a=t.units[t.selectedUnit];a!==o&&!a.attackUsed&&function(t,e){var n=g(t);return Math.abs(n.x-e.x)+Math.abs(n.y-e.y)<=t.stats.range}(a,n)&&(a.attackUsed=!0,a.stats.attack>=o.positions.length&&delete t.units[o.stats.id],o.positions.splice(0,a.stats.attack))}},endTurn:function(t){t.turn++;var e,n=Object(h.a)(L(t));try{for(n.s();!(e=n.n()).done;){var r=e.value;r.movesUsed=0,r.attackUsed=!1}}catch(o){n.e(o)}finally{n.f()}}}}),S=M.actions,E=S.move,_=S.select,T=S.attack,z=S.reset,B=S.endTurn,G=function(t){return t.selectedUnit?t.units[t.selectedUnit]:void 0},L=function(t){return Object.values(t.units)},A=Object(p.a)(G,L,(function(t){return t.gridSize}),(function(t){var e,n={};return t?((e=t,O(g(e),e.stats.range)).forEach((function(t){n[b(t)]="#ff0000"})),t.positions.forEach((function(t){n[b(t)]="#384bfa"})),n):n})),J=Object(p.a)(G,L,(function(t){return t.gridSize}),(function(t,e,n){var r={};(e.forEach((function(t){t.positions.forEach((function(e){r[b(e)]=t.stats.color})),r[b(g(t))]=t.stats.headColor})),t)&&function(t,e,n){if(t.attackUsed)return[];for(var r,o={position:g(t),movement:t.stats.movement-t.movesUsed},a=n.width,i=n.height,c=[o],s=[],u=o;0!==c.length;){var f=c.shift();if(void 0===f)return[];if(m((u=f).position,g(t))||s.push(u.position),0!==u.movement){var l,d=(r=u.position,O(r,1)),v=j(d,a,i),p=y(v,e),b=x(p,s),k=Object(h.a)(b);try{for(k.s();!(l=k.n()).done;){var w={position:l.value,movement:u.movement-1};c.push(w)}}catch(U){k.e(U)}finally{k.f()}}}return s}(t,e,n).forEach((function(t){r[b(t)]="rgb(200, 206, 255)"}));return r})),P=M.reducer,Q=n(1),R=function(t){var e=t.position,n=t.color,r=t.glowColor,o=f(),a=Object(u.c)((function(t){return L(t.game)})),i=function(t){switch(t.button){case 0:if(function(t,e){return void 0===C(t,e)}(e,a)){o(E(e));break}o(_(e));break;case 2:o(T(e)),t.preventDefault()}},c={backgroundColor:n,boxShadow:r?"0px 0px 10px"+r:void 0};return Object(Q.jsx)("div",{style:c,onContextMenu:i,onClick:i})},W=function(t,e,n){return Object(s.a)(Array(t.height*t.width).keys()).map((function(r){var o=function(t,e){return{x:Math.floor(t/e.width),y:t%e.height}}(r,t),a=e[b(o)],i=n[b(o)];return Object(Q.jsx)(R,{color:i,glowColor:a,position:o},r)}))};function D(){var t=f(),e=Object(u.c)((function(t){return Object(c.a)(Object(c.a)({},t.game),{},{selectedUnit:G(t.game),gridGlows:A(t.game),gridColors:J(t.game)})})),n=e.gridSize,r=e.phase,a=e.selectedUnit,i=e.turn,s=e.gridGlows,l=e.gridColors;return Object(Q.jsxs)(o.a.Fragment,{children:[Object(Q.jsxs)("p",{children:["Turn ",i+1]})," ",Object(Q.jsx)("button",{onClick:function(){return t(B())},children:"End Turn"}),Object(Q.jsxs)("p",{children:[r,void 0!==a?": "+a.stats.name:""]}),Object(Q.jsx)("div",{className:d.a.wrapper,children:W(n,s,l)}),Object(Q.jsx)("button",{onClick:function(){return t(z())},children:"reset"})]})}var F=function(){return Object(Q.jsx)(D,{})},H=n(12),I=n.n(H),N=n(15);function Y(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new Promise((function(e){return setTimeout((function(){return e({data:t})}),500)}))}var $=Object(v.b)("counter/fetchCount",function(){var t=Object(N.a)(I.a.mark((function t(e){var n;return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y(e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),q=Object(v.c)({name:"counter",initialState:{value:0,status:"idle"},reducers:{increment:function(t){t.value+=1},decrement:function(t){t.value-=1},incrementByAmount:function(t,e){t.value+=e.payload}},extraReducers:function(t){t.addCase($.pending,(function(t){t.status="loading"})).addCase($.fulfilled,(function(t,e){t.status="idle",t.value+=e.payload}))}}),K=q.actions,V=(K.increment,K.decrement,K.incrementByAmount,q.reducer),X=Object(v.a)({reducer:{counter:V,game:P}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(Q.jsx)(o.a.StrictMode,{children:Object(Q.jsx)(u.a,{store:X,children:Object(Q.jsx)(F,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[29,1,2]]]);
//# sourceMappingURL=main.89ef0d3d.chunk.js.map